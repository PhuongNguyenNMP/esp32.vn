<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:image" content="../../../img/logo.png"/>

  
  <meta name="author" content="Tuan PM">
  
  <title>Partition Tables - Internet Of Things (IoT) với ESP32</title>
  

  <link rel="shortcut icon" href="../../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">

  <link rel="stylesheet" href="../../../css/custom.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Partition Tables";
    var mkdocs_page_input_path = "esp-idf/basic/partition-tables.md";
    var mkdocs_page_url = "/esp-idf/basic/partition-tables/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script>
  <script src="../../../js/theme.js"></script>
  <script src="../../../js/jquery.cookie-1.4.1.min.js"></script>
  <script src="../../../js/nav.js"></script> 

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-60470603-7', 'esp32.vn');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Internet Of Things (IoT) với ESP32</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../.." id="Trang chủ" style="font-size:95%;font-weight:bold;">Trang chủ</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="current">
        <a class="current"  id="Nội dung" style="font-size:95%;font-weight:bold;">Nội dung</a>
    </li>
    
        <li class="">
            <a style="padding-left:50px;" class="" href="../../../introduction/" id="Giới thiệu về ESP32"> Giới thiệu về ESP32</a>
        </li>
        
        <div style="display:none" id="hidden_Giới thiệu về ESP32">
        
        </div>
    
        <li class="">
            <a style="padding-left:50px;" class="" href="../../../hardware/" id="Phần cứng hỗ trợ"> Phần cứng hỗ trợ</a>
        </li>
        
        <div style="display:none" id="hidden_Phần cứng hỗ trợ">
        
        </div>
    
        <li class="">
            <a style="padding-left:50px;" class=""  id="ESP32 Arduino" onclick="showChildren('ESP32 Arduino')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i> ESP32 Arduino</a>
        </li>
        
        <div style="display:none" id="hidden_ESP32 Arduino">
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../arduino/arduino/" id="Giới thiệu">  Giới thiệu </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP32 ArduinoGiới thiệu">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../arduino/install/" id="Cài đặt">  Cài đặt </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP32 ArduinoGiới thiệuCài đặt">
            
            </div>
        
        </div>
    
        <li class="current">
            <a style="padding-left:50px;" class="current"  id="ESP32 ESP-IDF" onclick="showChildren('ESP32 ESP-IDF')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i> ESP32 ESP-IDF</a>
        </li>
        
        <div style="display:none" id="hidden_ESP32 ESP-IDF">
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../esp-idf/" id="Giới thiệu">  Giới thiệu </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP32 ESP-IDFGiới thiệu">
            
            </div>
        
            <li class="current">
                <a style="padding-left:70px;" class="current"  id="Cơ bản" onclick="showChildren('ESP32 ESP-IDFGiới thiệuCơ bản')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Cơ bản </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP32 ESP-IDFGiới thiệuCơ bản">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../build-system/" id="Hệ thống biên dịch">Hệ thống biên dịch </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../install-windows/" id="Cài đặt cho Windows">Cài đặt cho Windows </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../install-macos/" id="Cài đặt cho MacOS">Cài đặt cho MacOS </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../install-linux/" id="Cài đặt cho Linux">Cài đặt cho Linux </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../eclipse-setup/" id="Cài đặt cho Eclipse">Cài đặt cho Eclipse </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../openocd/" id="Sử dụng OpenOCD">Sử dụng OpenOCD </a>
                </li>
            
                <li class="current">
                    <a style="padding-left:90px;" class="current" href="./" id="Partition Tables">Partition Tables </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="API tham khảo" onclick="showChildren('ESP32 ESP-IDFGiới thiệuCơ bảnAPI tham khảo')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  API tham khảo </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP32 ESP-IDFGiới thiệuCơ bảnAPI tham khảo">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../api/wifi/" id="WiFi">WiFi </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../api/bluetooth/" id="Bluetooth - BLE">Bluetooth - BLE </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../api/gpio/" id="GPIO">GPIO </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../api/logging/" id="Logging">Logging </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../api/non-volatile-storage/" id="Non-Volatile Storage">Non-Volatile Storage </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../api/virtual-filesystem/" id="Virtual Filesystem">Virtual Filesystem </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../freertos/tutorial/" id="FreeRTOS">  FreeRTOS </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP32 ESP-IDFGiới thiệuCơ bảnAPI tham khảoFreeRTOS">
            
            </div>
        
        </div>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../../projects/project-list/" id="Các dự án" style="font-size:95%;font-weight:bold;">Các dự án</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../../license/" id="Bản quyền" style="font-size:95%;font-weight:bold;">Bản quyền</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../../contributor/" id="Đóng góp" style="font-size:95%;font-weight:bold;">Đóng góp</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Internet Of Things (IoT) với ESP32</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
    <ul class="wy-breadcrumbs">
        <li><a href="../../..">Docs</a> &raquo;</li>
          
        <li>ESP32 ESP-IDF &raquo;</li>
          
        <li>Cơ bản &raquo;</li>
           
        <li>Partition Tables</li>
        <li class="wy-breadcrumbs-aside">
             
                
            <a href="https://github.com/esp32vn/esp32.vn/tree/master/docs/esp-idf/basic/partition-tables.md" class="icon icon-github"> Edit on GitHub</a>
                
             
        </li>
    </ul>
    <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="partition-tables">Partition Tables<a class="headerlink" href="#partition-tables" title="Permanent link">#</a></h2>
<p>A single ESP32&rsquo;s flash can contain multiple apps, as well as many different kinds of data (calibration data, filesystems, parameter storage, etc). For this reason a partition table is flashed to offset 0x4000 in the flash.</p>
<p>Each entry in the partition table has a name (label), type (app, data, or something else), subtype and the offset in flash where the partition is loaded.</p>
<p>The simplest way to use the partition table is to <code>make menuconfig</code> and choose one of the simple predefined partition tables:</p>
<ul>
<li>&ldquo;Single factory app, no OTA&rdquo;</li>
<li>&ldquo;Factory app, two OTA definitions&rdquo;</li>
</ul>
<p>In both cases the factory app is flashed at offset 0x10000. If you <code>make partition_table</code> then it will print a summary of the partition table.</p>
<h2 id="known-issues">Known Issues<a class="headerlink" href="#known-issues" title="Permanent link">#</a></h2>
<p>The below design document outlines the goals for the partition table system. At the moment, only some features are used:</p>
<ul>
<li>data partition types &ldquo;rf&rdquo; &amp; &ldquo;wifi&rdquo; are unused and can be entirely omitted to save space.</li>
<li>NVS (non-volatile-storage) uses a hardcoded 12KB (0x3000 byte) region at offset 0x6000.</li>
</ul>
<p>Once a full user API is in place for partition access, these limitations will be resolved and you&rsquo;ll be able to use the partition mechanism fully for storing data in flash.</p>
<h2 id="built-in-partition-tables">Built-in Partition Tables<a class="headerlink" href="#built-in-partition-tables" title="Permanent link">#</a></h2>
<p>Here is the summary printed for the &ldquo;Single factory app, no OTA&rdquo; configuration::</p>
<p># Espressif ESP32 Partition Table
  # Name,  Type, SubType, Offset,  Size
  factory, app,  factory, 0x10000, 1M
  rfdata,  data, rf,     0x110000, 256K
  wifidata,data, wifi,   0x150000, 256K</p>
<ul>
<li>At a 0x10000 (64KB) offset in the flash is the app labelled &ldquo;factory&rdquo;. The bootloader will run this app by default.</li>
<li>There are also two data regions defined in the partition table for storing RF &amp; Wifi calibration data.</li>
</ul>
<p>Here is the summary printed for the &ldquo;Factory app, two OTA definitions&rdquo; configuration::</p>
<p># Espressif ESP32 Partition Table
  # Name,  Type, SubType, Offset,  Size
  factory, app,  factory,  0x10000, 1M
  ota_0,   app,  ota_0,   0x110000, 1M
  ota_1,   app,  ota_1,   0x210000, 1M
  rfdata,  data, rf,      0x310000, 256K
  wifidata,data, wifi,    0x350000, 256K
  otadata, data, ota,     0x390000, 256K</p>
<ul>
<li>There are now three app partition definitions.</li>
<li>The type of all three are set as &ldquo;app&rdquo;, but the subtype varies between the factory app at 0x10000 and the next two &ldquo;OTA&rdquo; apps.</li>
<li>There is also a new &ldquo;ota data&rdquo; slot, which holds the data for OTA updates. The bootloader consults this data in order to know which app to execute. If &ldquo;ota data&rdquo; is empty, it will execute the factory app.</li>
</ul>
<h2 id="creating-custom-tables">Creating Custom Tables<a class="headerlink" href="#creating-custom-tables" title="Permanent link">#</a></h2>
<p>If you choose &ldquo;Custom partition table CSV&rdquo; in menuconfig then you can also enter the name of a CSV file (in the project directory) to use for your partition table. The CSV file can describe any number of definitions for the table you need.</p>
<p>The CSV format is the same format as printed in the summaries shown above. However, not all fields are required in the CSV. For example, here is the &ldquo;input&rdquo; CSV for the OTA partition table::</p>
<p># Name,   Type, SubType, Offset,   Size
  factory,  app,  factory, 0x10000,  1M
  ota_0,    app,  ota_0,   ,         1M
  ota_1,    app,  ota_1,   ,         1M
  rfdata,   data, rf,      ,         256K
  wifidata, data, wifi,    ,         256K
  otadata,  data, ota,     ,         256K</p>
<ul>
<li>Whitespace between fields is ignored, and so is any line starting with # (comments).</li>
<li>Each non-comment line in the CSV file is a partition definition.</li>
<li>Only the offset for the first partition is supplied. The gen_esp32part.py tool fills in each remaining offset to start after the preceding partition.</li>
</ul>
<p>Name field</p>
<pre><code>
Name field can be any meaningful name. It is not significant to the ESP32. Names longer than 16 characters will be truncated.

Type field
</code></pre>

<p>Type field can be specified as app (0) or data (1). Or it can be a number 0-254 (or as hex 0x00-0xFE). Types 0x00-0x3F are reserved for Espressif. If your application needs to store data, please add a custom partition type in the range 0x40-0xFE.</p>
<p>The bootloader ignores any types other than 0 &amp; 1.</p>
<p>Subtype
~~~~~~~</p>
<p>When type is &ldquo;app&rdquo;, the subtype field can be specified as factory (0), ota_0 (0x10) &hellip; ota_15 (0x1F) and test (0x20). Or it can be any number 0-255 (0x00-0xFF). The bootloader will execute the factory app unless there it sees a partition of type data/ota, in which case it reads this partition to determine which OTA image to boot</p>
<p>When type is &ldquo;data&rdquo;, the subtype field can be specified as ota (0), rf (1), wifi (2). Or it can be a number 0x00-0xFF. The bootloader ignores all data subtypes except for ota. Other &ldquo;data&rdquo; subtypes are reserved for Espressif use. To create custom data partition subtypes then use a custom type value, and choose any subtype 0x00-0xFF.</p>
<p>Offset &amp; Size
~~~~~~~~~~~~~</p>
<p>Only the first offset field is required (we recommend using 0x10000). Partitions with blank offsets will start after the previous partition.</p>
<p>App partitions have to be at offsets aligned to 0x10000 (64K). If you leave the offset field blank, the tool will automatically align the partition. If you specify an unaligned offset for an app partition, the tool will return an error.</p>
<p>Sizes and offsets can be specified as decimal numbers, hex numbers with the prefix 0x, or size multipliers M or K (1024 and 1024*1024 bytes).</p>
<h2 id="generating-binary-partition-table">Generating Binary Partition Table<a class="headerlink" href="#generating-binary-partition-table" title="Permanent link">#</a></h2>
<p>The partition table which is flashed to the ESP32 is in a binary format, not CSV. The tool bin/gen_esp32part.py is used to convert between CSV and binary formats.</p>
<p>If you configure the partition table CSV name in <code>make menuconfig</code> and then <code>make partition_table</code>, this conversion is done for you.</p>
<p>To convert CSV to Binary manually::</p>
<p>python bin/gen_esp32part.py &ndash;verify input_partitions.csv binary_partitions.bin</p>
<p>To convert binary format back to CSV::</p>
<p>python bin/gen_esp32part.py &ndash;verify binary_partitions.bin input_partitions.csv</p>
<p>To display the contents of a binary partition table on stdout (this is how the summaries displayed when running <code>make partition_table</code> are generated::</p>
<p>python bin/gen_esp32part.py binary_partitions.bin</p>
<p><code>gen_esp32part.py</code> takes one optional argument, <code>--verify</code>, which will also verify the partition table during conversion (checking for overlapping partitions, unaligned partitions, etc.)</p>
<h2 id="flashing-the-partition-table">Flashing the partition table<a class="headerlink" href="#flashing-the-partition-table" title="Permanent link">#</a></h2>
<ul>
<li><code>make partition_table-flash</code>: will flash the partition table with esptool.py.</li>
<li><code>make flash</code>: Will flash everything including the partition table.</li>
</ul>
<p>A manual flashing command is also printed as part of <code>make partition_table</code>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../api/wifi/" class="btn btn-neutral float-right" title="WiFi">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../openocd/" class="btn btn-neutral" title="Sử dụng OpenOCD"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2016 <a href="https://esp32.vn">ESP32 Việt Nam</a></p>
    
  </div>

  
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<!-- <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/esp32vn/esp32.vn" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../openocd/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../api/wifi/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div> -->

<script type="text/javascript">
  // If cookie is defined toggle the id
  if (typeof $.cookie('docToggle') !== 'undefined') {
      // Parse cookie which is an array
      var _parsed_cookie = JSON.parse($.cookie('docToggle'));
      // Loop over array and show hidden divs
      $.each(_parsed_cookie, function(index, value) {
          // Toggle
          $("[id='hidden_" + value + "']").css('display','');
      })
  }
</script>

</body>
</html>